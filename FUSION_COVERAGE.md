# Kernel Fusion Coverage Report

Generated by `cargo run --bin fusion_coverage -- --write FUSION_COVERAGE.md`.

## Summary

| Model | DSL | WGSL | Synthesized | Legacy eligible for DSL migration | Pair opportunities (safe) | Pair opportunities (aggressive-only) | Pair opportunities blocked by WGSL |
|---|---:|---:|---:|---:|---:|---:|---:|
| `compressible` | 3 | 4 | 0 | 0 | 1 | 0 | 0 |
| `generic_diffusion_demo` | 3 | 2 | 0 | 0 | 1 | 0 | 0 |
| `generic_diffusion_demo_neumann` | 3 | 2 | 0 | 0 | 1 | 0 | 0 |
| `incompressible_momentum` | 7 | 5 | 5 | 0 | 2 | 2 | 0 |

## Per-Model Details

### `compressible`

| Kernel | Phase | Dispatch | Condition | Scope | Implementation | Eligible for DSL migration | Notes |
|---|---|---|---|---|---|---|---|
| `generic_coupled_apply` | Apply | Cells | RequiresImplicitStepping | Shared | WGSL | no | - |
| `generic_coupled_assembly` | Assembly | Cells | RequiresNoGradState | PerModel | DSL | no | - |
| `generic_coupled_assembly_grad_state` | Assembly | Cells | RequiresGradState | PerModel | DSL | no | - |
| `flux_module` | FluxComputation | Faces | Always | PerModel | WGSL | no | - |
| `flux_module_gradients` | Gradients | Cells | Always | PerModel | WGSL | no | - |
| `packed_state_gradients` | Gradients | Cells | RequiresGradState | PerModel | WGSL | no | - |
| `generic_coupled_update` | Update | Cells | Always | PerModel | DSL | no | - |

#### Adjacent Fusion Reassessment

| Pair | Phase | Dispatch | Artifacts | Existing rule | Safe fuseable | Aggressive fuseable | Notes |
|---|---|---|---|---|---|---|---|
| `generic_coupled_assembly -> generic_coupled_assembly_grad_state` | Assembly | Cells | DSL + DSL | - | yes | yes | - |

#### Declared Fusion Rule Reassessment

| Rule | Min policy | Pattern | Replacement | Safe synthesizeable | Aggressive synthesizeable | Notes |
|---|---|---|---|---|---|---|

### `generic_diffusion_demo`

| Kernel | Phase | Dispatch | Condition | Scope | Implementation | Eligible for DSL migration | Notes |
|---|---|---|---|---|---|---|---|
| `generic_coupled_apply` | Apply | Cells | RequiresImplicitStepping | Shared | WGSL | no | - |
| `generic_coupled_assembly` | Assembly | Cells | RequiresNoGradState | PerModel | DSL | no | - |
| `generic_coupled_assembly_grad_state` | Assembly | Cells | RequiresGradState | PerModel | DSL | no | - |
| `packed_state_gradients` | Gradients | Cells | RequiresGradState | PerModel | WGSL | no | - |
| `generic_coupled_update` | Update | Cells | Always | PerModel | DSL | no | - |

#### Adjacent Fusion Reassessment

| Pair | Phase | Dispatch | Artifacts | Existing rule | Safe fuseable | Aggressive fuseable | Notes |
|---|---|---|---|---|---|---|---|
| `generic_coupled_assembly -> generic_coupled_assembly_grad_state` | Assembly | Cells | DSL + DSL | - | yes | yes | - |

#### Declared Fusion Rule Reassessment

| Rule | Min policy | Pattern | Replacement | Safe synthesizeable | Aggressive synthesizeable | Notes |
|---|---|---|---|---|---|---|

### `generic_diffusion_demo_neumann`

| Kernel | Phase | Dispatch | Condition | Scope | Implementation | Eligible for DSL migration | Notes |
|---|---|---|---|---|---|---|---|
| `generic_coupled_apply` | Apply | Cells | RequiresImplicitStepping | Shared | WGSL | no | - |
| `generic_coupled_assembly` | Assembly | Cells | RequiresNoGradState | PerModel | DSL | no | - |
| `generic_coupled_assembly_grad_state` | Assembly | Cells | RequiresGradState | PerModel | DSL | no | - |
| `packed_state_gradients` | Gradients | Cells | RequiresGradState | PerModel | WGSL | no | - |
| `generic_coupled_update` | Update | Cells | Always | PerModel | DSL | no | - |

#### Adjacent Fusion Reassessment

| Pair | Phase | Dispatch | Artifacts | Existing rule | Safe fuseable | Aggressive fuseable | Notes |
|---|---|---|---|---|---|---|---|
| `generic_coupled_assembly -> generic_coupled_assembly_grad_state` | Assembly | Cells | DSL + DSL | - | yes | yes | - |

#### Declared Fusion Rule Reassessment

| Rule | Min policy | Pattern | Replacement | Safe synthesizeable | Aggressive synthesizeable | Notes |
|---|---|---|---|---|---|---|

### `incompressible_momentum`

| Kernel | Phase | Dispatch | Condition | Scope | Implementation | Eligible for DSL migration | Notes |
|---|---|---|---|---|---|---|---|
| `generic_coupled_apply` | Apply | Cells | RequiresImplicitStepping | Shared | WGSL | no | - |
| `generic_coupled_assembly` | Assembly | Cells | RequiresNoGradState | PerModel | DSL | no | - |
| `generic_coupled_assembly_grad_state` | Assembly | Cells | RequiresGradState | PerModel | DSL | no | - |
| `flux_module` | FluxComputation | Faces | Always | PerModel | WGSL | no | - |
| `flux_module_gradients` | Gradients | Cells | Always | PerModel | WGSL | no | - |
| `packed_state_gradients` | Gradients | Cells | RequiresGradState | PerModel | WGSL | no | - |
| `dp_init` | Preparation | Cells | Always | PerModel | WGSL | no | - |
| `dp_update_from_diag` | Update | Cells | Always | PerModel | DSL | no | - |
| `generic_coupled_update` | Update | Cells | Always | PerModel | DSL | no | - |
| `rhie_chow/correct_velocity_delta` | Update | Cells | Always | PerModel | DSL | no | - |
| `rhie_chow/dp_update_store_grad_p_fused` | Update | Cells | Always | - | Synthesized | no | replacement kernel synthesized from fusion DSL inputs |
| `rhie_chow/dp_update_store_grad_p_grad_p_update_correct_velocity_delta_fused` | Update | Cells | Always | - | Synthesized | no | replacement kernel synthesized from fusion DSL inputs |
| `rhie_chow/dp_update_store_grad_p_grad_p_update_fused` | Update | Cells | Always | - | Synthesized | no | replacement kernel synthesized from fusion DSL inputs |
| `rhie_chow/grad_p_update` | Update | Cells | Always | PerModel | DSL | no | - |
| `rhie_chow/grad_p_update_correct_velocity_delta_fused` | Update | Cells | Always | - | Synthesized | no | replacement kernel synthesized from fusion DSL inputs |
| `rhie_chow/store_grad_p` | Update | Cells | Always | PerModel | DSL | no | - |
| `rhie_chow/store_grad_p_grad_p_update_fused` | Update | Cells | Always | - | Synthesized | no | replacement kernel synthesized from fusion DSL inputs |

#### Adjacent Fusion Reassessment

| Pair | Phase | Dispatch | Artifacts | Existing rule | Safe fuseable | Aggressive fuseable | Notes |
|---|---|---|---|---|---|---|---|
| `generic_coupled_assembly -> generic_coupled_assembly_grad_state` | Assembly | Cells | DSL + DSL | - | yes | yes | - |
| `dp_update_from_diag -> rhie_chow/store_grad_p` | Update | Cells | DSL + DSL | rhie_chow:dp_update_store_grad_p_v1 | yes | yes | - |
| `rhie_chow/store_grad_p -> rhie_chow/grad_p_update` | Update | Cells | DSL + DSL | rhie_chow:store_grad_p_grad_p_update_v1 | no (fusion rejected: WAR hazard at kernel 'rhie_chow/grad_p_update') | yes | aggressive-only opportunity |
| `rhie_chow/grad_p_update -> rhie_chow/correct_velocity_delta` | Update | Cells | DSL + DSL | rhie_chow:grad_p_update_correct_velocity_delta_v1 | no (fusion rejected: RAW hazard at kernel 'rhie_chow/correct_velocity_delta') | yes | aggressive-only opportunity |

#### Declared Fusion Rule Reassessment

| Rule | Min policy | Pattern | Replacement | Safe synthesizeable | Aggressive synthesizeable | Notes |
|---|---|---|---|---|---|---|
| `rhie_chow:dp_update_store_grad_p_grad_p_update_correct_velocity_delta_v1` | Aggressive | `dp_update_from_diag` -> `rhie_chow/store_grad_p` -> `rhie_chow/grad_p_update` -> `rhie_chow/correct_velocity_delta` | `rhie_chow/dp_update_store_grad_p_grad_p_update_correct_velocity_delta_fused` | no (fusion rejected: WAR hazard at kernel 'rhie_chow/grad_p_update') | yes | aggressive-only synthesis path |
| `rhie_chow:dp_update_store_grad_p_grad_p_update_v1` | Aggressive | `dp_update_from_diag` -> `rhie_chow/store_grad_p` -> `rhie_chow/grad_p_update` | `rhie_chow/dp_update_store_grad_p_grad_p_update_fused` | no (fusion rejected: WAR hazard at kernel 'rhie_chow/grad_p_update') | yes | aggressive-only synthesis path |
| `rhie_chow:dp_update_store_grad_p_v1` | Safe | `dp_update_from_diag` -> `rhie_chow/store_grad_p` | `rhie_chow/dp_update_store_grad_p_fused` | yes | yes | - |
| `rhie_chow:grad_p_update_correct_velocity_delta_v1` | Aggressive | `rhie_chow/grad_p_update` -> `rhie_chow/correct_velocity_delta` | `rhie_chow/grad_p_update_correct_velocity_delta_fused` | no (fusion rejected: RAW hazard at kernel 'rhie_chow/correct_velocity_delta') | yes | aggressive-only synthesis path |
| `rhie_chow:store_grad_p_grad_p_update_v1` | Aggressive | `rhie_chow/store_grad_p` -> `rhie_chow/grad_p_update` | `rhie_chow/store_grad_p_grad_p_update_fused` | no (fusion rejected: WAR hazard at kernel 'rhie_chow/grad_p_update') | yes | aggressive-only synthesis path |
