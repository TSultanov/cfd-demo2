# Kernel Fusion Coverage Report

Generated by `cargo run --bin fusion_coverage -- --write FUSION_COVERAGE.md`.

## Summary

| Model | DSL | WGSL | Synthesized | Legacy eligible for DSL migration | Pair opportunities (safe) | Pair opportunities (aggressive-only) | Pair opportunities blocked by WGSL |
|---|---:|---:|---:|---:|---:|---:|---:|
| `compressible` | 0 | 7 | 0 | 3 | 0 | 0 | 1 |
| `generic_diffusion_demo` | 0 | 5 | 0 | 3 | 0 | 0 | 1 |
| `generic_diffusion_demo_neumann` | 0 | 5 | 0 | 3 | 0 | 0 | 1 |
| `incompressible_momentum` | 3 | 9 | 1 | 4 | 1 | 0 | 3 |

## Per-Model Details

### `compressible`

| Kernel | Phase | Dispatch | Condition | Scope | Implementation | Eligible for DSL migration | Notes |
|---|---|---|---|---|---|---|---|
| `generic_coupled_apply` | Apply | Cells | RequiresImplicitStepping | Shared | WGSL | no | - |
| `generic_coupled_assembly` | Assembly | Cells | RequiresNoGradState | PerModel | WGSL | yes | - |
| `generic_coupled_assembly_grad_state` | Assembly | Cells | RequiresGradState | PerModel | WGSL | yes | - |
| `flux_module` | FluxComputation | Faces | Always | PerModel | WGSL | no | - |
| `flux_module_gradients` | Gradients | Cells | Always | PerModel | WGSL | no | - |
| `packed_state_gradients` | Gradients | Cells | RequiresGradState | PerModel | WGSL | no | - |
| `generic_coupled_update` | Update | Cells | Always | PerModel | WGSL | yes | - |

#### Adjacent Fusion Reassessment

| Pair | Phase | Dispatch | Artifacts | Existing rule | Safe fuseable | Aggressive fuseable | Notes |
|---|---|---|---|---|---|---|---|
| `generic_coupled_assembly -> generic_coupled_assembly_grad_state` | Assembly | Cells | WGSL + WGSL | - | no (requires DSL migration) | no (requires DSL migration) | artifacts: WGSL + WGSL |

### `generic_diffusion_demo`

| Kernel | Phase | Dispatch | Condition | Scope | Implementation | Eligible for DSL migration | Notes |
|---|---|---|---|---|---|---|---|
| `generic_coupled_apply` | Apply | Cells | RequiresImplicitStepping | Shared | WGSL | no | - |
| `generic_coupled_assembly` | Assembly | Cells | RequiresNoGradState | PerModel | WGSL | yes | - |
| `generic_coupled_assembly_grad_state` | Assembly | Cells | RequiresGradState | PerModel | WGSL | yes | - |
| `packed_state_gradients` | Gradients | Cells | RequiresGradState | PerModel | WGSL | no | - |
| `generic_coupled_update` | Update | Cells | Always | PerModel | WGSL | yes | - |

#### Adjacent Fusion Reassessment

| Pair | Phase | Dispatch | Artifacts | Existing rule | Safe fuseable | Aggressive fuseable | Notes |
|---|---|---|---|---|---|---|---|
| `generic_coupled_assembly -> generic_coupled_assembly_grad_state` | Assembly | Cells | WGSL + WGSL | - | no (requires DSL migration) | no (requires DSL migration) | artifacts: WGSL + WGSL |

### `generic_diffusion_demo_neumann`

| Kernel | Phase | Dispatch | Condition | Scope | Implementation | Eligible for DSL migration | Notes |
|---|---|---|---|---|---|---|---|
| `generic_coupled_apply` | Apply | Cells | RequiresImplicitStepping | Shared | WGSL | no | - |
| `generic_coupled_assembly` | Assembly | Cells | RequiresNoGradState | PerModel | WGSL | yes | - |
| `generic_coupled_assembly_grad_state` | Assembly | Cells | RequiresGradState | PerModel | WGSL | yes | - |
| `packed_state_gradients` | Gradients | Cells | RequiresGradState | PerModel | WGSL | no | - |
| `generic_coupled_update` | Update | Cells | Always | PerModel | WGSL | yes | - |

#### Adjacent Fusion Reassessment

| Pair | Phase | Dispatch | Artifacts | Existing rule | Safe fuseable | Aggressive fuseable | Notes |
|---|---|---|---|---|---|---|---|
| `generic_coupled_assembly -> generic_coupled_assembly_grad_state` | Assembly | Cells | WGSL + WGSL | - | no (requires DSL migration) | no (requires DSL migration) | artifacts: WGSL + WGSL |

### `incompressible_momentum`

| Kernel | Phase | Dispatch | Condition | Scope | Implementation | Eligible for DSL migration | Notes |
|---|---|---|---|---|---|---|---|
| `generic_coupled_apply` | Apply | Cells | RequiresImplicitStepping | Shared | WGSL | no | - |
| `generic_coupled_assembly` | Assembly | Cells | RequiresNoGradState | PerModel | WGSL | yes | - |
| `generic_coupled_assembly_grad_state` | Assembly | Cells | RequiresGradState | PerModel | WGSL | yes | - |
| `flux_module` | FluxComputation | Faces | Always | PerModel | WGSL | no | - |
| `flux_module_gradients` | Gradients | Cells | Always | PerModel | WGSL | no | - |
| `packed_state_gradients` | Gradients | Cells | RequiresGradState | PerModel | WGSL | no | - |
| `dp_init` | Preparation | Cells | Always | PerModel | WGSL | no | - |
| `dp_update_from_diag` | Update | Cells | Always | PerModel | DSL | no | - |
| `generic_coupled_update` | Update | Cells | Always | PerModel | WGSL | yes | - |
| `rhie_chow/correct_velocity_delta` | Update | Cells | Always | PerModel | DSL | no | - |
| `rhie_chow/dp_update_store_grad_p_fused` | Update | Cells | Always | - | Synthesized | no | replacement kernel synthesized from fusion DSL inputs |
| `rhie_chow/grad_p_update` | Update | Cells | Always | PerModel | WGSL | yes | - |
| `rhie_chow/store_grad_p` | Update | Cells | Always | PerModel | DSL | no | - |

#### Adjacent Fusion Reassessment

| Pair | Phase | Dispatch | Artifacts | Existing rule | Safe fuseable | Aggressive fuseable | Notes |
|---|---|---|---|---|---|---|---|
| `generic_coupled_assembly -> generic_coupled_assembly_grad_state` | Assembly | Cells | WGSL + WGSL | - | no (requires DSL migration) | no (requires DSL migration) | artifacts: WGSL + WGSL |
| `dp_update_from_diag -> rhie_chow/store_grad_p` | Update | Cells | DSL + DSL | rhie_chow:dp_update_store_grad_p_v1 | yes | yes | - |
| `rhie_chow/store_grad_p -> rhie_chow/grad_p_update` | Update | Cells | DSL + WGSL | - | no (requires DSL migration) | no (requires DSL migration) | artifacts: DSL + WGSL |
| `rhie_chow/grad_p_update -> rhie_chow/correct_velocity_delta` | Update | Cells | WGSL + DSL | - | no (requires DSL migration) | no (requires DSL migration) | artifacts: WGSL + DSL |
