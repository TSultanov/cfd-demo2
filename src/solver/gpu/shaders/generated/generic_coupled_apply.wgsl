// GENERATED BY CFD2 CODEGEN (generic_coupled_apply)

// DO NOT EDIT MANUALLY

// Group 0: CSR matrix

@group(0) @binding(0) 
var<storage, read> row_offsets: array<u32>;

@group(0) @binding(1) 
var<storage, read> col_indices: array<u32>;

@group(0) @binding(2) 
var<storage, read> matrix_values: array<f32>;

// Group 1: vectors

@group(1) @binding(0) 
var<storage, read> x: array<f32>;

@group(1) @binding(1) 
var<storage, read_write> y: array<f32>;

@compute
@workgroup_size(64)
fn main(@builtin(global_invocation_id) global_id: vec3<u32>) {
    let row = global_id.x;
    let n = arrayLength(&row_offsets) - 1u;
    if (row >= n) {
        return;
    }
    let start = row_offsets[row];
    let end = row_offsets[row + 1u];
    var sum: f32 = 0.0;
    for (var k = start; k < end; k++) {
        let col = col_indices[k];
        sum += matrix_values[k] * x[col];
    }
    y[row] = sum;
}
