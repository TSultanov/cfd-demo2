// GENERATED BY CFD2 CODEGEN (flux_module)

// DO NOT EDIT MANUALLY

struct Vector2 {
    x: f32,
    y: f32,
}

struct Constants {
    dt: f32,
    dt_old: f32,
    dtau: f32,
    time: f32,
    viscosity: f32,
    density: f32,
    component: u32,
    alpha_p: f32,
    scheme: u32,
    alpha_u: f32,
    stride_x: u32,
    time_scheme: u32,
    eos_gamma: f32,
    eos_gm1: f32,
    eos_r: f32,
    eos_dp_drho: f32,
    eos_p_offset: f32,
    eos_theta_ref: f32,
}

struct LowMachParams {
    model: u32,
    theta_floor: f32,
    pressure_coupling_alpha: f32,
    _pad0: f32,
}

// Group 0: Mesh

@group(0) @binding(0) 
var<storage, read> face_owner: array<u32>;

@group(0) @binding(1) 
var<storage, read> face_neighbor: array<i32>;

@group(0) @binding(2) 
var<storage, read> face_areas: array<f32>;

@group(0) @binding(3) 
var<storage, read> face_normals: array<Vector2>;

@group(0) @binding(4) 
var<storage, read> cell_centers: array<Vector2>;

@group(0) @binding(12) 
var<storage, read> face_boundary: array<u32>;

@group(0) @binding(13) 
var<storage, read> face_centers: array<Vector2>;

// Group 1: Fields

@group(1) @binding(0) 
var<storage, read_write> state: array<f32>;

@group(1) @binding(1) 
var<storage, read> state_old: array<f32>;

@group(1) @binding(2) 
var<storage, read> state_old_old: array<f32>;

@group(1) @binding(3) 
var<storage, read_write> fluxes: array<f32>;

@group(1) @binding(4) 
var<uniform> constants: Constants;

@group(1) @binding(5) 
var<uniform> low_mach_params: LowMachParams;

// Group 2: Boundary conditions (per face x unknown)

@group(2) @binding(0) 
var<storage, read> bc_kind: array<u32>;

@group(2) @binding(1) 
var<storage, read> bc_value: array<f32>;

@compute
@workgroup_size(64)
fn main(@builtin(global_invocation_id) global_id: vec3<u32>) {
    let idx = global_id.y * constants.stride_x + global_id.x;
    if (idx >= arrayLength(&face_areas)) {
        return;
    }
    let owner = face_owner[idx];
    let neighbor = face_neighbor[idx];
    let is_boundary = neighbor == -1;
    var neigh_idx: u32 = owner;
    if (neighbor != -1) {
        neigh_idx = u32(neighbor);
    }
    let area = face_areas[idx];
    let boundary_type = face_boundary[idx];
    let face_center = face_centers[idx];
    var normal_vec: vec2<f32> = vec2<f32>(face_normals[idx].x, face_normals[idx].y);
    let c_owner = cell_centers[owner];
    let c_owner_vec: vec2<f32> = vec2<f32>(c_owner.x, c_owner.y);
    let face_center_vec: vec2<f32> = vec2<f32>(face_center.x, face_center.y);
    if (dot(face_center_vec - c_owner_vec, normal_vec) < 0.0) {
        normal_vec = -normal_vec;
    }
    let c_neigh = cell_centers[neigh_idx];
    var c_neigh_vec: vec2<f32> = vec2<f32>(c_neigh.x, c_neigh.y);
    let c_neigh_cell_vec: vec2<f32> = c_neigh_vec;
    if (is_boundary) {
        c_neigh_vec = face_center_vec;
    }
    let d_own = distance(c_owner_vec, face_center_vec);
    let d_neigh = distance(c_neigh_vec, face_center_vec);
    let total_dist = d_own + d_neigh;
    var lambda: f32 = 0.5;
    if (total_dist > 0.000001) {
        lambda = d_neigh / total_dist;
    }
    let lambda_other = 1.0 - lambda;
    let d_vec: vec2<f32> = c_neigh_vec - c_owner_vec;
    let dist_proj = abs(dot(d_vec, normal_vec));
    let dist = max(dist_proj, 0.000001);
    var a_plus: f32 = max(0.0, max(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * 1.0 / state[owner * 8u + 0u], normal_vec) + sqrt(max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0)) * (constants.eos_gamma * state[owner * 8u + 4u] / state[owner * 8u + 0u] + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 0.0)) * min(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * 1.0 / state[owner * 8u + 0u], normal_vec) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * 1.0 / state[owner * 8u + 0u], normal_vec), constants.eos_gamma * state[owner * 8u + 4u] / state[owner * 8u + 0u] + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 1.0)) * min(max(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * 1.0 / state[owner * 8u + 0u], normal_vec) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * 1.0 / state[owner * 8u + 0u], normal_vec), low_mach_params.theta_floor * (constants.eos_gamma * state[owner * 8u + 4u] / state[owner * 8u + 0u] + constants.eos_dp_drho)), constants.eos_gamma * state[owner * 8u + 4u] / state[owner * 8u + 0u] + constants.eos_dp_drho)), dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * 1.0 / select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), normal_vec) + sqrt(max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0)) * (constants.eos_gamma * select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) / select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 0.0)) * min(dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * 1.0 / select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * 1.0 / select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), normal_vec), constants.eos_gamma * select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) / select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 1.0)) * min(max(dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * 1.0 / select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * 1.0 / select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), normal_vec), low_mach_params.theta_floor * (constants.eos_gamma * select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) / select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + constants.eos_dp_drho)), constants.eos_gamma * select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) / select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + constants.eos_dp_drho))));
    var a_minus: f32 = min(0.0, min(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * 1.0 / state[owner * 8u + 0u], normal_vec) - sqrt(max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0)) * (constants.eos_gamma * state[owner * 8u + 4u] / state[owner * 8u + 0u] + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 0.0)) * min(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * 1.0 / state[owner * 8u + 0u], normal_vec) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * 1.0 / state[owner * 8u + 0u], normal_vec), constants.eos_gamma * state[owner * 8u + 4u] / state[owner * 8u + 0u] + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 1.0)) * min(max(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * 1.0 / state[owner * 8u + 0u], normal_vec) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * 1.0 / state[owner * 8u + 0u], normal_vec), low_mach_params.theta_floor * (constants.eos_gamma * state[owner * 8u + 4u] / state[owner * 8u + 0u] + constants.eos_dp_drho)), constants.eos_gamma * state[owner * 8u + 4u] / state[owner * 8u + 0u] + constants.eos_dp_drho)), dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * 1.0 / select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), normal_vec) - sqrt(max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0)) * (constants.eos_gamma * select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) / select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 0.0)) * min(dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * 1.0 / select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * 1.0 / select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), normal_vec), constants.eos_gamma * select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) / select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 1.0)) * min(max(dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * 1.0 / select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * 1.0 / select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), normal_vec), low_mach_params.theta_floor * (constants.eos_gamma * select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) / select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + constants.eos_dp_drho)), constants.eos_gamma * select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) / select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + constants.eos_dp_drho))));
    a_plus = select(a_plus, max(0.0, max(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) * 1.0 / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), normal_vec) + sqrt(max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0)) * (constants.eos_gamma * (state[owner * 8u + 4u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 0.0)) * min(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) * 1.0 / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) * 1.0 / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), normal_vec), constants.eos_gamma * (state[owner * 8u + 4u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 1.0)) * min(max(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) * 1.0 / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) * 1.0 / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), normal_vec), low_mach_params.theta_floor * (constants.eos_gamma * (state[owner * 8u + 4u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + constants.eos_dp_drho)), constants.eos_gamma * (state[owner * 8u + 4u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + constants.eos_dp_drho)), dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), normal_vec) + sqrt(max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0)) * (constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 0.0)) * min(dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), normal_vec), constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 1.0)) * min(max(dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), normal_vec), low_mach_params.theta_floor * (constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + constants.eos_dp_drho)), constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + constants.eos_dp_drho)))), constants.scheme == 1u && !is_boundary);
    a_minus = select(a_minus, min(0.0, min(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) * 1.0 / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), normal_vec) - sqrt(max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0)) * (constants.eos_gamma * (state[owner * 8u + 4u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 0.0)) * min(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) * 1.0 / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) * 1.0 / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), normal_vec), constants.eos_gamma * (state[owner * 8u + 4u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 1.0)) * min(max(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) * 1.0 / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) * 1.0 / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), normal_vec), low_mach_params.theta_floor * (constants.eos_gamma * (state[owner * 8u + 4u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + constants.eos_dp_drho)), constants.eos_gamma * (state[owner * 8u + 4u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + constants.eos_dp_drho)), dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), normal_vec) - sqrt(max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0)) * (constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 0.0)) * min(dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), normal_vec), constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 1.0)) * min(max(dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), normal_vec), low_mach_params.theta_floor * (constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + constants.eos_dp_drho)), constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + constants.eos_dp_drho)))), constants.scheme == 1u && !is_boundary);
    a_plus = select(a_plus, max(0.0, max(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * 1.0 / (state[owner * 8u + 0u] + state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), normal_vec) + sqrt(max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0)) * (constants.eos_gamma * (state[owner * 8u + 4u] + state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]) / (state[owner * 8u + 0u] + state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 0.0)) * min(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * 1.0 / (state[owner * 8u + 0u] + state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * 1.0 / (state[owner * 8u + 0u] + state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), normal_vec), constants.eos_gamma * (state[owner * 8u + 4u] + state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]) / (state[owner * 8u + 0u] + state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 1.0)) * min(max(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * 1.0 / (state[owner * 8u + 0u] + state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * 1.0 / (state[owner * 8u + 0u] + state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), normal_vec), low_mach_params.theta_floor * (constants.eos_gamma * (state[owner * 8u + 4u] + state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]) / (state[owner * 8u + 0u] + state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) + constants.eos_dp_drho)), constants.eos_gamma * (state[owner * 8u + 4u] + state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]) / (state[owner * 8u + 0u] + state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) + constants.eos_dp_drho)), dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), normal_vec) + sqrt(max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0)) * (constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 0.0)) * min(dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), normal_vec), constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 1.0)) * min(max(dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), normal_vec), low_mach_params.theta_floor * (constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) + constants.eos_dp_drho)), constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) + constants.eos_dp_drho)))), constants.scheme == 2u && !is_boundary);
    a_minus = select(a_minus, min(0.0, min(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * 1.0 / (state[owner * 8u + 0u] + state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), normal_vec) - sqrt(max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0)) * (constants.eos_gamma * (state[owner * 8u + 4u] + state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]) / (state[owner * 8u + 0u] + state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 0.0)) * min(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * 1.0 / (state[owner * 8u + 0u] + state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * 1.0 / (state[owner * 8u + 0u] + state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), normal_vec), constants.eos_gamma * (state[owner * 8u + 4u] + state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]) / (state[owner * 8u + 0u] + state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 1.0)) * min(max(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * 1.0 / (state[owner * 8u + 0u] + state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * 1.0 / (state[owner * 8u + 0u] + state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), normal_vec), low_mach_params.theta_floor * (constants.eos_gamma * (state[owner * 8u + 4u] + state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]) / (state[owner * 8u + 0u] + state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) + constants.eos_dp_drho)), constants.eos_gamma * (state[owner * 8u + 4u] + state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]) / (state[owner * 8u + 0u] + state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) + constants.eos_dp_drho)), dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), normal_vec) - sqrt(max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0)) * (constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 0.0)) * min(dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), normal_vec), constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 1.0)) * min(max(dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), normal_vec), low_mach_params.theta_floor * (constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) + constants.eos_dp_drho)), constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) + constants.eos_dp_drho)))), constants.scheme == 2u && !is_boundary);
    a_plus = select(a_plus, max(0.0, max(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (state[owner * 8u + 0u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))), normal_vec) + sqrt(max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0)) * (constants.eos_gamma * (state[owner * 8u + 4u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0)), max(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0))) / (state[owner * 8u + 0u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 0.0)) * min(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (state[owner * 8u + 0u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (state[owner * 8u + 0u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))), normal_vec), constants.eos_gamma * (state[owner * 8u + 4u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0)), max(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0))) / (state[owner * 8u + 0u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 1.0)) * min(max(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (state[owner * 8u + 0u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (state[owner * 8u + 0u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))), normal_vec), low_mach_params.theta_floor * (constants.eos_gamma * (state[owner * 8u + 4u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0)), max(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0))) / (state[owner * 8u + 0u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))) + constants.eos_dp_drho)), constants.eos_gamma * (state[owner * 8u + 4u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0)), max(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0))) / (state[owner * 8u + 0u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))) + constants.eos_dp_drho)), dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))), normal_vec) + sqrt(max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0)) * (constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0))) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 0.0)) * min(dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))), normal_vec), constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0))) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 1.0)) * min(max(dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))), normal_vec), low_mach_params.theta_floor * (constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0))) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))) + constants.eos_dp_drho)), constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0))) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))) + constants.eos_dp_drho)))), constants.scheme == 3u && !is_boundary);
    a_minus = select(a_minus, min(0.0, min(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (state[owner * 8u + 0u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))), normal_vec) - sqrt(max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0)) * (constants.eos_gamma * (state[owner * 8u + 4u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0)), max(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0))) / (state[owner * 8u + 0u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 0.0)) * min(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (state[owner * 8u + 0u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (state[owner * 8u + 0u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))), normal_vec), constants.eos_gamma * (state[owner * 8u + 4u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0)), max(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0))) / (state[owner * 8u + 0u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 1.0)) * min(max(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (state[owner * 8u + 0u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (state[owner * 8u + 0u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))), normal_vec), low_mach_params.theta_floor * (constants.eos_gamma * (state[owner * 8u + 4u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0)), max(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0))) / (state[owner * 8u + 0u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))) + constants.eos_dp_drho)), constants.eos_gamma * (state[owner * 8u + 4u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0)), max(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0))) / (state[owner * 8u + 0u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))) + constants.eos_dp_drho)), dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))), normal_vec) - sqrt(max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0)) * (constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0))) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 0.0)) * min(dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))), normal_vec), constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0))) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 1.0)) * min(max(dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))), normal_vec), low_mach_params.theta_floor * (constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0))) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))) + constants.eos_dp_drho)), constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0))) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))) + constants.eos_dp_drho)))), constants.scheme == 3u && !is_boundary);
    a_plus = select(a_plus, max(0.0, max(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)) * 1.0 / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)), normal_vec) + sqrt(max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0)) * (constants.eos_gamma * (state[owner * 8u + 4u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)) / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 0.0)) * min(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)) * 1.0 / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)) * 1.0 / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)), normal_vec), constants.eos_gamma * (state[owner * 8u + 4u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)) / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 1.0)) * min(max(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)) * 1.0 / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)) * 1.0 / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)), normal_vec), low_mach_params.theta_floor * (constants.eos_gamma * (state[owner * 8u + 4u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)) / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)) + constants.eos_dp_drho)), constants.eos_gamma * (state[owner * 8u + 4u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)) / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)) + constants.eos_dp_drho)), dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)), normal_vec) + sqrt(max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0)) * (constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 0.0)) * min(dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)), normal_vec), constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 1.0)) * min(max(dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)), normal_vec), low_mach_params.theta_floor * (constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)) + constants.eos_dp_drho)), constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)) + constants.eos_dp_drho)))), constants.scheme == 4u && !is_boundary);
    a_minus = select(a_minus, min(0.0, min(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)) * 1.0 / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)), normal_vec) - sqrt(max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0)) * (constants.eos_gamma * (state[owner * 8u + 4u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)) / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 0.0)) * min(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)) * 1.0 / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)) * 1.0 / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)), normal_vec), constants.eos_gamma * (state[owner * 8u + 4u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)) / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 1.0)) * min(max(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)) * 1.0 / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)) * 1.0 / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)), normal_vec), low_mach_params.theta_floor * (constants.eos_gamma * (state[owner * 8u + 4u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)) / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)) + constants.eos_dp_drho)), constants.eos_gamma * (state[owner * 8u + 4u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)) / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)) + constants.eos_dp_drho)), dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)), normal_vec) - sqrt(max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0)) * (constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 0.0)) * min(dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)), normal_vec), constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 1.0)) * min(max(dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)), normal_vec), low_mach_params.theta_floor * (constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)) + constants.eos_dp_drho)), constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)) + constants.eos_dp_drho)))), constants.scheme == 4u && !is_boundary);
    a_plus = select(a_plus, max(0.0, max(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + min(max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + min(max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (state[owner * 8u + 0u] + min(max(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u], min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))), normal_vec) + sqrt(max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0)) * (constants.eos_gamma * (state[owner * 8u + 4u] + min(max(state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u], min(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0)), max(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0))) / (state[owner * 8u + 0u] + min(max(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u], min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 0.0)) * min(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + min(max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + min(max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (state[owner * 8u + 0u] + min(max(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u], min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + min(max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + min(max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (state[owner * 8u + 0u] + min(max(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u], min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))), normal_vec), constants.eos_gamma * (state[owner * 8u + 4u] + min(max(state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u], min(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0)), max(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0))) / (state[owner * 8u + 0u] + min(max(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u], min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 1.0)) * min(max(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + min(max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + min(max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (state[owner * 8u + 0u] + min(max(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u], min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + min(max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + min(max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (state[owner * 8u + 0u] + min(max(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u], min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))), normal_vec), low_mach_params.theta_floor * (constants.eos_gamma * (state[owner * 8u + 4u] + min(max(state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u], min(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0)), max(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0))) / (state[owner * 8u + 0u] + min(max(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u], min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))) + constants.eos_dp_drho)), constants.eos_gamma * (state[owner * 8u + 4u] + min(max(state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u], min(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0)), max(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0))) / (state[owner * 8u + 0u] + min(max(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u], min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))) + constants.eos_dp_drho)), dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + min(max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + min(max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))), normal_vec) + sqrt(max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0)) * (constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), min(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0))) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 0.0)) * min(dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + min(max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + min(max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + min(max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + min(max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))), normal_vec), constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), min(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0))) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 1.0)) * min(max(dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + min(max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + min(max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + min(max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + min(max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))), normal_vec), low_mach_params.theta_floor * (constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), min(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0))) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))) + constants.eos_dp_drho)), constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), min(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0))) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))) + constants.eos_dp_drho)))), constants.scheme == 5u && !is_boundary);
    a_minus = select(a_minus, min(0.0, min(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + min(max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + min(max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (state[owner * 8u + 0u] + min(max(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u], min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))), normal_vec) - sqrt(max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0)) * (constants.eos_gamma * (state[owner * 8u + 4u] + min(max(state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u], min(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0)), max(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0))) / (state[owner * 8u + 0u] + min(max(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u], min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 0.0)) * min(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + min(max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + min(max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (state[owner * 8u + 0u] + min(max(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u], min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + min(max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + min(max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (state[owner * 8u + 0u] + min(max(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u], min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))), normal_vec), constants.eos_gamma * (state[owner * 8u + 4u] + min(max(state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u], min(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0)), max(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0))) / (state[owner * 8u + 0u] + min(max(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u], min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 1.0)) * min(max(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + min(max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + min(max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (state[owner * 8u + 0u] + min(max(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u], min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + min(max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + min(max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (state[owner * 8u + 0u] + min(max(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u], min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))), normal_vec), low_mach_params.theta_floor * (constants.eos_gamma * (state[owner * 8u + 4u] + min(max(state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u], min(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0)), max(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0))) / (state[owner * 8u + 0u] + min(max(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u], min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))) + constants.eos_dp_drho)), constants.eos_gamma * (state[owner * 8u + 4u] + min(max(state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u], min(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0)), max(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0))) / (state[owner * 8u + 0u] + min(max(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u], min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))) + constants.eos_dp_drho)), dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + min(max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + min(max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))), normal_vec) - sqrt(max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0)) * (constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), min(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0))) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 0.0)) * min(dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + min(max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + min(max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + min(max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + min(max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))), normal_vec), constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), min(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0))) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 1.0)) * min(max(dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + min(max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + min(max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + min(max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + min(max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))), normal_vec), low_mach_params.theta_floor * (constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), min(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0))) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))) + constants.eos_dp_drho)), constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), min(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0))) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))) + constants.eos_dp_drho)))), constants.scheme == 5u && !is_boundary);
    a_plus = select(a_plus, max(0.0, max(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)))), 0.00000001), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)))), 0.00000001)) * 1.0 / (state[owner * 8u + 0u] + (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u])), 0.00000001)), normal_vec) + sqrt(max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0)) * (constants.eos_gamma * (state[owner * 8u + 4u] + (state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]) * abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]), abs(state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * (state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * (state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u])), 0.00000001)) / (state[owner * 8u + 0u] + (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u])), 0.00000001)) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 0.0)) * min(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)))), 0.00000001), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)))), 0.00000001)) * 1.0 / (state[owner * 8u + 0u] + (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u])), 0.00000001)), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)))), 0.00000001), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)))), 0.00000001)) * 1.0 / (state[owner * 8u + 0u] + (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u])), 0.00000001)), normal_vec), constants.eos_gamma * (state[owner * 8u + 4u] + (state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]) * abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]), abs(state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * (state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * (state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u])), 0.00000001)) / (state[owner * 8u + 0u] + (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u])), 0.00000001)) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 1.0)) * min(max(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)))), 0.00000001), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)))), 0.00000001)) * 1.0 / (state[owner * 8u + 0u] + (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u])), 0.00000001)), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)))), 0.00000001), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)))), 0.00000001)) * 1.0 / (state[owner * 8u + 0u] + (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u])), 0.00000001)), normal_vec), low_mach_params.theta_floor * (constants.eos_gamma * (state[owner * 8u + 4u] + (state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]) * abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]), abs(state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * (state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * (state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u])), 0.00000001)) / (state[owner * 8u + 0u] + (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u])), 0.00000001)) + constants.eos_dp_drho)), constants.eos_gamma * (state[owner * 8u + 4u] + (state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]) * abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]), abs(state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * (state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * (state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u])), 0.00000001)) / (state[owner * 8u + 0u] + (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u])), 0.00000001)) + constants.eos_dp_drho)), dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)))), 0.00000001), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)))), 0.00000001)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary))), 0.00000001)), normal_vec) + sqrt(max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0)) * (constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary))), 0.00000001)) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary))), 0.00000001)) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 0.0)) * min(dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)))), 0.00000001), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)))), 0.00000001)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary))), 0.00000001)), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)))), 0.00000001), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)))), 0.00000001)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary))), 0.00000001)), normal_vec), constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary))), 0.00000001)) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary))), 0.00000001)) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 1.0)) * min(max(dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)))), 0.00000001), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)))), 0.00000001)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary))), 0.00000001)), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)))), 0.00000001), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)))), 0.00000001)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary))), 0.00000001)), normal_vec), low_mach_params.theta_floor * (constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary))), 0.00000001)) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary))), 0.00000001)) + constants.eos_dp_drho)), constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary))), 0.00000001)) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary))), 0.00000001)) + constants.eos_dp_drho)))), constants.scheme == 6u && !is_boundary);
    a_minus = select(a_minus, min(0.0, min(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)))), 0.00000001), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)))), 0.00000001)) * 1.0 / (state[owner * 8u + 0u] + (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u])), 0.00000001)), normal_vec) - sqrt(max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0)) * (constants.eos_gamma * (state[owner * 8u + 4u] + (state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]) * abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]), abs(state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * (state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * (state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u])), 0.00000001)) / (state[owner * 8u + 0u] + (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u])), 0.00000001)) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 0.0)) * min(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)))), 0.00000001), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)))), 0.00000001)) * 1.0 / (state[owner * 8u + 0u] + (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u])), 0.00000001)), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)))), 0.00000001), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)))), 0.00000001)) * 1.0 / (state[owner * 8u + 0u] + (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u])), 0.00000001)), normal_vec), constants.eos_gamma * (state[owner * 8u + 4u] + (state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]) * abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]), abs(state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * (state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * (state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u])), 0.00000001)) / (state[owner * 8u + 0u] + (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u])), 0.00000001)) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 1.0)) * min(max(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)))), 0.00000001), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)))), 0.00000001)) * 1.0 / (state[owner * 8u + 0u] + (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u])), 0.00000001)), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)))), 0.00000001), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)))), 0.00000001)) * 1.0 / (state[owner * 8u + 0u] + (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u])), 0.00000001)), normal_vec), low_mach_params.theta_floor * (constants.eos_gamma * (state[owner * 8u + 4u] + (state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]) * abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]), abs(state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * (state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * (state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u])), 0.00000001)) / (state[owner * 8u + 0u] + (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u])), 0.00000001)) + constants.eos_dp_drho)), constants.eos_gamma * (state[owner * 8u + 4u] + (state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]) * abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]), abs(state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * (state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * (state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u])), 0.00000001)) / (state[owner * 8u + 0u] + (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u])), 0.00000001)) + constants.eos_dp_drho)), dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)))), 0.00000001), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)))), 0.00000001)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary))), 0.00000001)), normal_vec) - sqrt(max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0)) * (constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary))), 0.00000001)) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary))), 0.00000001)) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 0.0)) * min(dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)))), 0.00000001), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)))), 0.00000001)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary))), 0.00000001)), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)))), 0.00000001), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)))), 0.00000001)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary))), 0.00000001)), normal_vec), constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary))), 0.00000001)) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary))), 0.00000001)) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 1.0)) * min(max(dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)))), 0.00000001), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)))), 0.00000001)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary))), 0.00000001)), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)))), 0.00000001), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)))), 0.00000001)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary))), 0.00000001)), normal_vec), low_mach_params.theta_floor * (constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary))), 0.00000001)) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary))), 0.00000001)) + constants.eos_dp_drho)), constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary))), 0.00000001)) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary))), 0.00000001)) + constants.eos_dp_drho)))), constants.scheme == 6u && !is_boundary);
    let denom = max(a_plus - a_minus, 0.000001);
    var u_l_0: f32 = state[owner * 8u + 0u] + (1.0 - max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0))) * low_mach_params.pressure_coupling_alpha * (state[owner * 8u + 4u] - (state[owner * 8u + 0u] * constants.eos_theta_ref + state[owner * 8u + 0u] * constants.eos_dp_drho - constants.eos_p_offset)) / max(max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0)) * (constants.eos_gamma * state[owner * 8u + 4u] / state[owner * 8u + 0u] + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 0.0)) * min(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * 1.0 / state[owner * 8u + 0u], normal_vec) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * 1.0 / state[owner * 8u + 0u], normal_vec), constants.eos_gamma * state[owner * 8u + 4u] / state[owner * 8u + 0u] + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 1.0)) * min(max(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * 1.0 / state[owner * 8u + 0u], normal_vec) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * 1.0 / state[owner * 8u + 0u], normal_vec), low_mach_params.theta_floor * (constants.eos_gamma * state[owner * 8u + 4u] / state[owner * 8u + 0u] + constants.eos_dp_drho)), constants.eos_gamma * state[owner * 8u + 4u] / state[owner * 8u + 0u] + constants.eos_dp_drho), 0.000000000001);
    var u_r_0: f32 = select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + (1.0 - max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0))) * low_mach_params.pressure_coupling_alpha * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * constants.eos_theta_ref + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * constants.eos_dp_drho - constants.eos_p_offset)) / max(max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0)) * (constants.eos_gamma * select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) / select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 0.0)) * min(dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * 1.0 / select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * 1.0 / select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), normal_vec), constants.eos_gamma * select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) / select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 1.0)) * min(max(dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * 1.0 / select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * 1.0 / select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), normal_vec), low_mach_params.theta_floor * (constants.eos_gamma * select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) / select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + constants.eos_dp_drho)), constants.eos_gamma * select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) / select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + constants.eos_dp_drho), 0.000000000001);
    var f_l_0: f32 = state[owner * 8u + 0u] * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * 1.0 / state[owner * 8u + 0u], normal_vec);
    var f_r_0: f32 = select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * 1.0 / select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), normal_vec);
    u_l_0 = select(u_l_0, state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) + (1.0 - max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0))) * low_mach_params.pressure_coupling_alpha * (state[owner * 8u + 4u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) - ((state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) * constants.eos_theta_ref + (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) * constants.eos_dp_drho - constants.eos_p_offset)) / max(max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0)) * (constants.eos_gamma * (state[owner * 8u + 4u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 0.0)) * min(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) * 1.0 / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) * 1.0 / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), normal_vec), constants.eos_gamma * (state[owner * 8u + 4u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 1.0)) * min(max(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) * 1.0 / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) * 1.0 / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), normal_vec), low_mach_params.theta_floor * (constants.eos_gamma * (state[owner * 8u + 4u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + constants.eos_dp_drho)), constants.eos_gamma * (state[owner * 8u + 4u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + constants.eos_dp_drho), 0.000000000001), constants.scheme == 1u && !is_boundary);
    u_r_0 = select(u_r_0, select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) + (1.0 - max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0))) * low_mach_params.pressure_coupling_alpha * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) - ((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) * constants.eos_theta_ref + (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) * constants.eos_dp_drho - constants.eos_p_offset)) / max(max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0)) * (constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 0.0)) * min(dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), normal_vec), constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 1.0)) * min(max(dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), normal_vec), low_mach_params.theta_floor * (constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + constants.eos_dp_drho)), constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + constants.eos_dp_drho), 0.000000000001), constants.scheme == 1u && !is_boundary);
    f_l_0 = select(f_l_0, (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) * 1.0 / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), normal_vec), constants.scheme == 1u && !is_boundary);
    f_r_0 = select(f_r_0, (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), normal_vec), constants.scheme == 1u && !is_boundary);
    u_l_0 = select(u_l_0, state[owner * 8u + 0u] + state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u] + (1.0 - max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0))) * low_mach_params.pressure_coupling_alpha * (state[owner * 8u + 4u] + state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u] - ((state[owner * 8u + 0u] + state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) * constants.eos_theta_ref + (state[owner * 8u + 0u] + state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) * constants.eos_dp_drho - constants.eos_p_offset)) / max(max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0)) * (constants.eos_gamma * (state[owner * 8u + 4u] + state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]) / (state[owner * 8u + 0u] + state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 0.0)) * min(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * 1.0 / (state[owner * 8u + 0u] + state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * 1.0 / (state[owner * 8u + 0u] + state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), normal_vec), constants.eos_gamma * (state[owner * 8u + 4u] + state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]) / (state[owner * 8u + 0u] + state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 1.0)) * min(max(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * 1.0 / (state[owner * 8u + 0u] + state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * 1.0 / (state[owner * 8u + 0u] + state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), normal_vec), low_mach_params.theta_floor * (constants.eos_gamma * (state[owner * 8u + 4u] + state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]) / (state[owner * 8u + 0u] + state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) + constants.eos_dp_drho)), constants.eos_gamma * (state[owner * 8u + 4u] + state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]) / (state[owner * 8u + 0u] + state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) + constants.eos_dp_drho), 0.000000000001), constants.scheme == 2u && !is_boundary);
    u_r_0 = select(u_r_0, select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + (1.0 - max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0))) * low_mach_params.pressure_coupling_alpha * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - ((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * constants.eos_theta_ref + (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * constants.eos_dp_drho - constants.eos_p_offset)) / max(max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0)) * (constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 0.0)) * min(dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), normal_vec), constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 1.0)) * min(max(dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), normal_vec), low_mach_params.theta_floor * (constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) + constants.eos_dp_drho)), constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) + constants.eos_dp_drho), 0.000000000001), constants.scheme == 2u && !is_boundary);
    f_l_0 = select(f_l_0, (state[owner * 8u + 0u] + state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * 1.0 / (state[owner * 8u + 0u] + state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), normal_vec), constants.scheme == 2u && !is_boundary);
    f_r_0 = select(f_r_0, (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), normal_vec), constants.scheme == 2u && !is_boundary);
    u_l_0 = select(u_l_0, state[owner * 8u + 0u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)) + (1.0 - max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0))) * low_mach_params.pressure_coupling_alpha * (state[owner * 8u + 4u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0)), max(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0)) - ((state[owner * 8u + 0u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))) * constants.eos_theta_ref + (state[owner * 8u + 0u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))) * constants.eos_dp_drho - constants.eos_p_offset)) / max(max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0)) * (constants.eos_gamma * (state[owner * 8u + 4u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0)), max(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0))) / (state[owner * 8u + 0u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 0.0)) * min(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (state[owner * 8u + 0u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (state[owner * 8u + 0u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))), normal_vec), constants.eos_gamma * (state[owner * 8u + 4u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0)), max(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0))) / (state[owner * 8u + 0u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 1.0)) * min(max(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (state[owner * 8u + 0u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (state[owner * 8u + 0u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))), normal_vec), low_mach_params.theta_floor * (constants.eos_gamma * (state[owner * 8u + 4u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0)), max(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0))) / (state[owner * 8u + 0u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))) + constants.eos_dp_drho)), constants.eos_gamma * (state[owner * 8u + 4u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0)), max(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0))) / (state[owner * 8u + 0u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))) + constants.eos_dp_drho), 0.000000000001), constants.scheme == 3u && !is_boundary);
    u_r_0 = select(u_r_0, select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)) + (1.0 - max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0))) * low_mach_params.pressure_coupling_alpha * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0)) - ((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))) * constants.eos_theta_ref + (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))) * constants.eos_dp_drho - constants.eos_p_offset)) / max(max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0)) * (constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0))) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 0.0)) * min(dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))), normal_vec), constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0))) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 1.0)) * min(max(dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))), normal_vec), low_mach_params.theta_floor * (constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0))) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))) + constants.eos_dp_drho)), constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0))) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))) + constants.eos_dp_drho), 0.000000000001), constants.scheme == 3u && !is_boundary);
    f_l_0 = select(f_l_0, (state[owner * 8u + 0u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (state[owner * 8u + 0u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))), normal_vec), constants.scheme == 3u && !is_boundary);
    f_r_0 = select(f_r_0, (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))), normal_vec), constants.scheme == 3u && !is_boundary);
    u_l_0 = select(u_l_0, state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001) + (1.0 - max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0))) * low_mach_params.pressure_coupling_alpha * (state[owner * 8u + 4u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001) - ((state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)) * constants.eos_theta_ref + (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)) * constants.eos_dp_drho - constants.eos_p_offset)) / max(max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0)) * (constants.eos_gamma * (state[owner * 8u + 4u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)) / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 0.0)) * min(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)) * 1.0 / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)) * 1.0 / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)), normal_vec), constants.eos_gamma * (state[owner * 8u + 4u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)) / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 1.0)) * min(max(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)) * 1.0 / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)) * 1.0 / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)), normal_vec), low_mach_params.theta_floor * (constants.eos_gamma * (state[owner * 8u + 4u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)) / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)) + constants.eos_dp_drho)), constants.eos_gamma * (state[owner * 8u + 4u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)) / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)) + constants.eos_dp_drho), 0.000000000001), constants.scheme == 4u && !is_boundary);
    u_r_0 = select(u_r_0, select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001) + (1.0 - max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0))) * low_mach_params.pressure_coupling_alpha * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001) - ((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)) * constants.eos_theta_ref + (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)) * constants.eos_dp_drho - constants.eos_p_offset)) / max(max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0)) * (constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 0.0)) * min(dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)), normal_vec), constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 1.0)) * min(max(dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)), normal_vec), low_mach_params.theta_floor * (constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)) + constants.eos_dp_drho)), constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)) + constants.eos_dp_drho), 0.000000000001), constants.scheme == 4u && !is_boundary);
    f_l_0 = select(f_l_0, (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)) * 1.0 / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)), normal_vec), constants.scheme == 4u && !is_boundary);
    f_r_0 = select(f_r_0, (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)), normal_vec), constants.scheme == 4u && !is_boundary);
    u_l_0 = select(u_l_0, state[owner * 8u + 0u] + min(max(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u], min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)) + (1.0 - max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0))) * low_mach_params.pressure_coupling_alpha * (state[owner * 8u + 4u] + min(max(state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u], min(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0)), max(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0)) - ((state[owner * 8u + 0u] + min(max(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u], min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))) * constants.eos_theta_ref + (state[owner * 8u + 0u] + min(max(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u], min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))) * constants.eos_dp_drho - constants.eos_p_offset)) / max(max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0)) * (constants.eos_gamma * (state[owner * 8u + 4u] + min(max(state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u], min(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0)), max(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0))) / (state[owner * 8u + 0u] + min(max(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u], min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 0.0)) * min(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + min(max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + min(max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (state[owner * 8u + 0u] + min(max(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u], min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + min(max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + min(max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (state[owner * 8u + 0u] + min(max(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u], min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))), normal_vec), constants.eos_gamma * (state[owner * 8u + 4u] + min(max(state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u], min(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0)), max(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0))) / (state[owner * 8u + 0u] + min(max(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u], min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 1.0)) * min(max(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + min(max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + min(max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (state[owner * 8u + 0u] + min(max(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u], min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + min(max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + min(max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (state[owner * 8u + 0u] + min(max(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u], min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))), normal_vec), low_mach_params.theta_floor * (constants.eos_gamma * (state[owner * 8u + 4u] + min(max(state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u], min(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0)), max(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0))) / (state[owner * 8u + 0u] + min(max(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u], min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))) + constants.eos_dp_drho)), constants.eos_gamma * (state[owner * 8u + 4u] + min(max(state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u], min(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0)), max(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0))) / (state[owner * 8u + 0u] + min(max(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u], min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))) + constants.eos_dp_drho), 0.000000000001), constants.scheme == 5u && !is_boundary);
    u_r_0 = select(u_r_0, select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)) + (1.0 - max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0))) * low_mach_params.pressure_coupling_alpha * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), min(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0)) - ((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))) * constants.eos_theta_ref + (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))) * constants.eos_dp_drho - constants.eos_p_offset)) / max(max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0)) * (constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), min(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0))) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 0.0)) * min(dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + min(max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + min(max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + min(max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + min(max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))), normal_vec), constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), min(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0))) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 1.0)) * min(max(dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + min(max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + min(max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + min(max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + min(max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))), normal_vec), low_mach_params.theta_floor * (constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), min(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0))) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))) + constants.eos_dp_drho)), constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), min(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0))) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))) + constants.eos_dp_drho), 0.000000000001), constants.scheme == 5u && !is_boundary);
    f_l_0 = select(f_l_0, (state[owner * 8u + 0u] + min(max(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u], min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + min(max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + min(max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (state[owner * 8u + 0u] + min(max(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u], min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))), normal_vec), constants.scheme == 5u && !is_boundary);
    f_r_0 = select(f_r_0, (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + min(max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + min(max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))), normal_vec), constants.scheme == 5u && !is_boundary);
    u_l_0 = select(u_l_0, state[owner * 8u + 0u] + (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u])), 0.00000001) + (1.0 - max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0))) * low_mach_params.pressure_coupling_alpha * (state[owner * 8u + 4u] + (state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]) * abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]), abs(state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * (state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * (state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u])), 0.00000001) - ((state[owner * 8u + 0u] + (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u])), 0.00000001)) * constants.eos_theta_ref + (state[owner * 8u + 0u] + (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u])), 0.00000001)) * constants.eos_dp_drho - constants.eos_p_offset)) / max(max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0)) * (constants.eos_gamma * (state[owner * 8u + 4u] + (state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]) * abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]), abs(state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * (state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * (state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u])), 0.00000001)) / (state[owner * 8u + 0u] + (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u])), 0.00000001)) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 0.0)) * min(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)))), 0.00000001), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)))), 0.00000001)) * 1.0 / (state[owner * 8u + 0u] + (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u])), 0.00000001)), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)))), 0.00000001), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)))), 0.00000001)) * 1.0 / (state[owner * 8u + 0u] + (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u])), 0.00000001)), normal_vec), constants.eos_gamma * (state[owner * 8u + 4u] + (state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]) * abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]), abs(state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * (state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * (state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u])), 0.00000001)) / (state[owner * 8u + 0u] + (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u])), 0.00000001)) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 1.0)) * min(max(dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)))), 0.00000001), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)))), 0.00000001)) * 1.0 / (state[owner * 8u + 0u] + (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u])), 0.00000001)), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)))), 0.00000001), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)))), 0.00000001)) * 1.0 / (state[owner * 8u + 0u] + (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u])), 0.00000001)), normal_vec), low_mach_params.theta_floor * (constants.eos_gamma * (state[owner * 8u + 4u] + (state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]) * abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]), abs(state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * (state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * (state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u])), 0.00000001)) / (state[owner * 8u + 0u] + (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u])), 0.00000001)) + constants.eos_dp_drho)), constants.eos_gamma * (state[owner * 8u + 4u] + (state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]) * abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]), abs(state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * (state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * (state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u])), 0.00000001)) / (state[owner * 8u + 0u] + (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u])), 0.00000001)) + constants.eos_dp_drho), 0.000000000001), constants.scheme == 6u && !is_boundary);
    u_r_0 = select(u_r_0, select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary))), 0.00000001) + (1.0 - max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0))) * low_mach_params.pressure_coupling_alpha * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary))), 0.00000001) - ((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary))), 0.00000001)) * constants.eos_theta_ref + (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary))), 0.00000001)) * constants.eos_dp_drho - constants.eos_p_offset)) / max(max(0.0, 1.0 - abs(f32(low_mach_params.model) - 2.0)) * (constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary))), 0.00000001)) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary))), 0.00000001)) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 0.0)) * min(dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)))), 0.00000001), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)))), 0.00000001)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary))), 0.00000001)), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)))), 0.00000001), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)))), 0.00000001)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary))), 0.00000001)), normal_vec), constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary))), 0.00000001)) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary))), 0.00000001)) + constants.eos_dp_drho) + max(0.0, 1.0 - abs(f32(low_mach_params.model) - 1.0)) * min(max(dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)))), 0.00000001), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)))), 0.00000001)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary))), 0.00000001)), normal_vec) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)))), 0.00000001), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)))), 0.00000001)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary))), 0.00000001)), normal_vec), low_mach_params.theta_floor * (constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary))), 0.00000001)) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary))), 0.00000001)) + constants.eos_dp_drho)), constants.eos_gamma * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary))), 0.00000001)) / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary))), 0.00000001)) + constants.eos_dp_drho), 0.000000000001), constants.scheme == 6u && !is_boundary);
    f_l_0 = select(f_l_0, (state[owner * 8u + 0u] + (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u])), 0.00000001)) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)))), 0.00000001), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)))), 0.00000001)) * 1.0 / (state[owner * 8u + 0u] + (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u])), 0.00000001)), normal_vec), constants.scheme == 6u && !is_boundary);
    f_r_0 = select(f_r_0, (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary))), 0.00000001)) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)))), 0.00000001), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)))), 0.00000001)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary))), 0.00000001)), normal_vec), constants.scheme == 6u && !is_boundary);
    fluxes[idx * 8u + 0u] = (a_plus * f_l_0 - a_minus * f_r_0 + a_plus * a_minus * (u_r_0 - u_l_0)) / denom * area;
    var u_l_1: f32 = dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0));
    var u_r_1: f32 = dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0));
    var f_l_1: f32 = dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * 1.0 / state[owner * 8u + 0u], normal_vec) + state[owner * 8u + 4u] * dot(normal_vec, vec2<f32>(1.0, 0.0));
    var f_r_1: f32 = dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * 1.0 / select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), normal_vec) + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * dot(normal_vec, vec2<f32>(1.0, 0.0));
    u_l_1 = select(u_l_1, dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), constants.scheme == 1u && !is_boundary);
    u_r_1 = select(u_r_1, dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), constants.scheme == 1u && !is_boundary);
    f_l_1 = select(f_l_1, (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) * 1.0 / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), normal_vec) + (state[owner * 8u + 4u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) * dot(normal_vec, vec2<f32>(1.0, 0.0)), constants.scheme == 1u && !is_boundary);
    f_r_1 = select(f_r_1, (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), normal_vec) + (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) * dot(normal_vec, vec2<f32>(1.0, 0.0)), constants.scheme == 1u && !is_boundary);
    u_l_1 = select(u_l_1, dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), constants.scheme == 2u && !is_boundary);
    u_r_1 = select(u_r_1, dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), constants.scheme == 2u && !is_boundary);
    f_l_1 = select(f_l_1, (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * 1.0 / (state[owner * 8u + 0u] + state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), normal_vec) + (state[owner * 8u + 4u] + state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]) * dot(normal_vec, vec2<f32>(1.0, 0.0)), constants.scheme == 2u && !is_boundary);
    f_r_1 = select(f_r_1, (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), normal_vec) + (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * dot(normal_vec, vec2<f32>(1.0, 0.0)), constants.scheme == 2u && !is_boundary);
    u_l_1 = select(u_l_1, dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), constants.scheme == 3u && !is_boundary);
    u_r_1 = select(u_r_1, dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), constants.scheme == 3u && !is_boundary);
    f_l_1 = select(f_l_1, (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0))) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (state[owner * 8u + 0u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))), normal_vec) + (state[owner * 8u + 4u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0)), max(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0))) * dot(normal_vec, vec2<f32>(1.0, 0.0)), constants.scheme == 3u && !is_boundary);
    f_r_1 = select(f_r_1, (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0))) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))), normal_vec) + (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0))) * dot(normal_vec, vec2<f32>(1.0, 0.0)), constants.scheme == 3u && !is_boundary);
    u_l_1 = select(u_l_1, dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001), constants.scheme == 4u && !is_boundary);
    u_r_1 = select(u_r_1, dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001), constants.scheme == 4u && !is_boundary);
    f_l_1 = select(f_l_1, (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)) * 1.0 / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)), normal_vec) + (state[owner * 8u + 4u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)) * dot(normal_vec, vec2<f32>(1.0, 0.0)), constants.scheme == 4u && !is_boundary);
    f_r_1 = select(f_r_1, (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)), normal_vec) + (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)) * dot(normal_vec, vec2<f32>(1.0, 0.0)), constants.scheme == 4u && !is_boundary);
    u_l_1 = select(u_l_1, dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + min(max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), constants.scheme == 5u && !is_boundary);
    u_r_1 = select(u_r_1, dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + min(max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), constants.scheme == 5u && !is_boundary);
    f_l_1 = select(f_l_1, (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + min(max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0))) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + min(max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + min(max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (state[owner * 8u + 0u] + min(max(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u], min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))), normal_vec) + (state[owner * 8u + 4u] + min(max(state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u], min(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0)), max(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0))) * dot(normal_vec, vec2<f32>(1.0, 0.0)), constants.scheme == 5u && !is_boundary);
    f_r_1 = select(f_r_1, (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + min(max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0))) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + min(max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + min(max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))), normal_vec) + (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), min(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0))) * dot(normal_vec, vec2<f32>(1.0, 0.0)), constants.scheme == 5u && !is_boundary);
    u_l_1 = select(u_l_1, dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)))), 0.00000001), constants.scheme == 6u && !is_boundary);
    u_r_1 = select(u_r_1, dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)))), 0.00000001), constants.scheme == 6u && !is_boundary);
    f_l_1 = select(f_l_1, (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)))), 0.00000001)) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)))), 0.00000001), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)))), 0.00000001)) * 1.0 / (state[owner * 8u + 0u] + (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u])), 0.00000001)), normal_vec) + (state[owner * 8u + 4u] + (state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]) * abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]), abs(state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * (state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * (state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u])), 0.00000001)) * dot(normal_vec, vec2<f32>(1.0, 0.0)), constants.scheme == 6u && !is_boundary);
    f_r_1 = select(f_r_1, (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)))), 0.00000001)) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)))), 0.00000001), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)))), 0.00000001)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary))), 0.00000001)), normal_vec) + (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary))), 0.00000001)) * dot(normal_vec, vec2<f32>(1.0, 0.0)), constants.scheme == 6u && !is_boundary);
    fluxes[idx * 8u + 1u] = (a_plus * f_l_1 - a_minus * f_r_1 + a_plus * a_minus * (u_r_1 - u_l_1)) / denom * area;
    var u_l_2: f32 = dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0));
    var u_r_2: f32 = dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0));
    var f_l_2: f32 = dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * 1.0 / state[owner * 8u + 0u], normal_vec) + state[owner * 8u + 4u] * dot(normal_vec, vec2<f32>(0.0, 1.0));
    var f_r_2: f32 = dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * 1.0 / select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), normal_vec) + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * dot(normal_vec, vec2<f32>(0.0, 1.0));
    u_l_2 = select(u_l_2, dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), constants.scheme == 1u && !is_boundary);
    u_r_2 = select(u_r_2, dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), constants.scheme == 1u && !is_boundary);
    f_l_2 = select(f_l_2, (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) * 1.0 / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), normal_vec) + (state[owner * 8u + 4u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) * dot(normal_vec, vec2<f32>(0.0, 1.0)), constants.scheme == 1u && !is_boundary);
    f_r_2 = select(f_r_2, (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), normal_vec) + (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) * dot(normal_vec, vec2<f32>(0.0, 1.0)), constants.scheme == 1u && !is_boundary);
    u_l_2 = select(u_l_2, dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), constants.scheme == 2u && !is_boundary);
    u_r_2 = select(u_r_2, dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), constants.scheme == 2u && !is_boundary);
    f_l_2 = select(f_l_2, (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * 1.0 / (state[owner * 8u + 0u] + state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), normal_vec) + (state[owner * 8u + 4u] + state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]) * dot(normal_vec, vec2<f32>(0.0, 1.0)), constants.scheme == 2u && !is_boundary);
    f_r_2 = select(f_r_2, (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), normal_vec) + (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * dot(normal_vec, vec2<f32>(0.0, 1.0)), constants.scheme == 2u && !is_boundary);
    u_l_2 = select(u_l_2, dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0)), constants.scheme == 3u && !is_boundary);
    u_r_2 = select(u_r_2, dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0)), constants.scheme == 3u && !is_boundary);
    f_l_2 = select(f_l_2, (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0))) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (state[owner * 8u + 0u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))), normal_vec) + (state[owner * 8u + 4u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0)), max(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0))) * dot(normal_vec, vec2<f32>(0.0, 1.0)), constants.scheme == 3u && !is_boundary);
    f_r_2 = select(f_r_2, (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0))) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))), normal_vec) + (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0))) * dot(normal_vec, vec2<f32>(0.0, 1.0)), constants.scheme == 3u && !is_boundary);
    u_l_2 = select(u_l_2, dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001), constants.scheme == 4u && !is_boundary);
    u_r_2 = select(u_r_2, dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001), constants.scheme == 4u && !is_boundary);
    f_l_2 = select(f_l_2, (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)) * 1.0 / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)), normal_vec) + (state[owner * 8u + 4u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)) * dot(normal_vec, vec2<f32>(0.0, 1.0)), constants.scheme == 4u && !is_boundary);
    f_r_2 = select(f_r_2, (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)), normal_vec) + (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)) * dot(normal_vec, vec2<f32>(0.0, 1.0)), constants.scheme == 4u && !is_boundary);
    u_l_2 = select(u_l_2, dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + min(max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0)), constants.scheme == 5u && !is_boundary);
    u_r_2 = select(u_r_2, dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + min(max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0)), constants.scheme == 5u && !is_boundary);
    f_l_2 = select(f_l_2, (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + min(max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0))) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + min(max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + min(max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (state[owner * 8u + 0u] + min(max(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u], min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))), normal_vec) + (state[owner * 8u + 4u] + min(max(state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u], min(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0)), max(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0))) * dot(normal_vec, vec2<f32>(0.0, 1.0)), constants.scheme == 5u && !is_boundary);
    f_r_2 = select(f_r_2, (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + min(max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0))) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + min(max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + min(max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))), normal_vec) + (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), min(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0))) * dot(normal_vec, vec2<f32>(0.0, 1.0)), constants.scheme == 5u && !is_boundary);
    u_l_2 = select(u_l_2, dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)))), 0.00000001), constants.scheme == 6u && !is_boundary);
    u_r_2 = select(u_r_2, dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)))), 0.00000001), constants.scheme == 6u && !is_boundary);
    f_l_2 = select(f_l_2, (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)))), 0.00000001)) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)))), 0.00000001), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)))), 0.00000001)) * 1.0 / (state[owner * 8u + 0u] + (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u])), 0.00000001)), normal_vec) + (state[owner * 8u + 4u] + (state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]) * abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]), abs(state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * (state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * (state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u])), 0.00000001)) * dot(normal_vec, vec2<f32>(0.0, 1.0)), constants.scheme == 6u && !is_boundary);
    f_r_2 = select(f_r_2, (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)))), 0.00000001)) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)))), 0.00000001), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)))), 0.00000001)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary))), 0.00000001)), normal_vec) + (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary))), 0.00000001)) * dot(normal_vec, vec2<f32>(0.0, 1.0)), constants.scheme == 6u && !is_boundary);
    fluxes[idx * 8u + 2u] = (a_plus * f_l_2 - a_minus * f_r_2 + a_plus * a_minus * (u_r_2 - u_l_2)) / denom * area;
    var u_l_3: f32 = state[owner * 8u + 3u];
    var u_r_3: f32 = select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary);
    var f_l_3: f32 = (state[owner * 8u + 3u] + state[owner * 8u + 4u]) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * 1.0 / state[owner * 8u + 0u], normal_vec);
    var f_r_3: f32 = (select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * 1.0 / select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), normal_vec);
    u_l_3 = select(u_l_3, state[owner * 8u + 3u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) - state[owner * 8u + 3u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), constants.scheme == 1u && !is_boundary);
    u_r_3 = select(u_r_3, select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 3u] - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), constants.scheme == 1u && !is_boundary);
    f_l_3 = select(f_l_3, (state[owner * 8u + 3u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) - state[owner * 8u + 3u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) + state[owner * 8u + 4u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) * 1.0 / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), normal_vec), constants.scheme == 1u && !is_boundary);
    f_r_3 = select(f_r_3, (select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 3u] - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), normal_vec), constants.scheme == 1u && !is_boundary);
    u_l_3 = select(u_l_3, state[owner * 8u + 3u] + state[owner * 8u + 3u] * 0.625 + select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) - state[owner * 8u + 3u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 3u], constants.scheme == 2u && !is_boundary);
    u_r_3 = select(u_r_3, select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 3u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 3u] - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary), constants.scheme == 2u && !is_boundary);
    f_l_3 = select(f_l_3, (state[owner * 8u + 3u] + state[owner * 8u + 3u] * 0.625 + select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) - state[owner * 8u + 3u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 3u] + state[owner * 8u + 4u] + state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * 1.0 / (state[owner * 8u + 0u] + state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), normal_vec), constants.scheme == 2u && !is_boundary);
    f_r_3 = select(f_r_3, (select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 3u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 3u] - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), normal_vec), constants.scheme == 2u && !is_boundary);
    u_l_3 = select(u_l_3, state[owner * 8u + 3u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) - state[owner * 8u + 3u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) - state[owner * 8u + 3u], 0.0)), max(select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) - state[owner * 8u + 3u], 0.0)), constants.scheme == 3u && !is_boundary);
    u_r_3 = select(u_r_3, select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 3u] - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 3u] - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 3u] - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary), 0.0)), constants.scheme == 3u && !is_boundary);
    f_l_3 = select(f_l_3, (state[owner * 8u + 3u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) - state[owner * 8u + 3u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) - state[owner * 8u + 3u], 0.0)), max(select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) - state[owner * 8u + 3u], 0.0)) + state[owner * 8u + 4u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0)), max(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0))) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (state[owner * 8u + 0u] + min(max(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))), normal_vec), constants.scheme == 3u && !is_boundary);
    f_r_3 = select(f_r_3, (select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 3u] - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 3u] - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 3u] - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary), 0.0)) + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0))) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))), normal_vec), constants.scheme == 3u && !is_boundary);
    u_l_3 = select(u_l_3, state[owner * 8u + 3u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) - state[owner * 8u + 3u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) - state[owner * 8u + 3u]) / max(abs(select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) - state[owner * 8u + 3u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) - state[owner * 8u + 3u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) - state[owner * 8u + 3u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) - state[owner * 8u + 3u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) - state[owner * 8u + 3u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) - state[owner * 8u + 3u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001), constants.scheme == 4u && !is_boundary);
    u_r_3 = select(u_r_3, select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 3u] - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 3u] - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 3u] - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 3u] - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 3u] - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 3u] - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 3u] - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 3u] - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001), constants.scheme == 4u && !is_boundary);
    f_l_3 = select(f_l_3, (state[owner * 8u + 3u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) - state[owner * 8u + 3u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) - state[owner * 8u + 3u]) / max(abs(select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) - state[owner * 8u + 3u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) - state[owner * 8u + 3u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) - state[owner * 8u + 3u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) - state[owner * 8u + 3u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) - state[owner * 8u + 3u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) - state[owner * 8u + 3u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001) + state[owner * 8u + 4u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)) * 1.0 / (state[owner * 8u + 0u] + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec)), 0.00000001)), normal_vec), constants.scheme == 4u && !is_boundary);
    f_r_3 = select(f_r_3, (select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 3u] - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 3u] - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 3u] - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 3u] - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 3u] - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 3u] - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 3u] - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 3u] - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001) + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec)), 0.00000001)), normal_vec), constants.scheme == 4u && !is_boundary);
    u_l_3 = select(u_l_3, state[owner * 8u + 3u] + min(max(state[owner * 8u + 3u] * 0.625 + select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) - state[owner * 8u + 3u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 3u], min(select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) - state[owner * 8u + 3u], 0.0)), max(select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) - state[owner * 8u + 3u], 0.0)), constants.scheme == 5u && !is_boundary);
    u_r_3 = select(u_r_3, select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 3u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 3u] - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary), min(state[owner * 8u + 3u] - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 3u] - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary), 0.0)), constants.scheme == 5u && !is_boundary);
    f_l_3 = select(f_l_3, (state[owner * 8u + 3u] + min(max(state[owner * 8u + 3u] * 0.625 + select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) - state[owner * 8u + 3u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 3u], min(select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) - state[owner * 8u + 3u], 0.0)), max(select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) - state[owner * 8u + 3u], 0.0)) + state[owner * 8u + 4u] + min(max(state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u], min(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0)), max(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u], 0.0))) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + min(max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + min(max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), min(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (state[owner * 8u + 0u] + min(max(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u], min(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0)), max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u], 0.0))), normal_vec), constants.scheme == 5u && !is_boundary);
    f_r_3 = select(f_r_3, (select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 3u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 3u] - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary), min(state[owner * 8u + 3u] - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 3u] - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary), 0.0)) + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), min(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary), 0.0))) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + min(max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)), 0.0)), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + min(max(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), min(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0)), max(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)), 0.0))) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + min(max(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), min(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0)), max(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary), 0.0))), normal_vec), constants.scheme == 5u && !is_boundary);
    u_l_3 = select(u_l_3, state[owner * 8u + 3u] + (state[owner * 8u + 3u] * 0.625 + select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) - state[owner * 8u + 3u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 3u]) * abs(select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) - state[owner * 8u + 3u]) / max(abs(select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) - state[owner * 8u + 3u]), abs(state[owner * 8u + 3u] * 0.625 + select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) - state[owner * 8u + 3u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 3u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) - state[owner * 8u + 3u]) * (state[owner * 8u + 3u] * 0.625 + select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) - state[owner * 8u + 3u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 3u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) - state[owner * 8u + 3u]) * (state[owner * 8u + 3u] * 0.625 + select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) - state[owner * 8u + 3u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 3u])), 0.00000001), constants.scheme == 6u && !is_boundary);
    u_r_3 = select(u_r_3, select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 3u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 3u] - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary)) * abs(state[owner * 8u + 3u] - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 3u] - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 3u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 3u] - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 3u] - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 3u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 3u] - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 3u] - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 3u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 3u] - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary))), 0.00000001), constants.scheme == 6u && !is_boundary);
    f_l_3 = select(f_l_3, (state[owner * 8u + 3u] + (state[owner * 8u + 3u] * 0.625 + select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) - state[owner * 8u + 3u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 3u]) * abs(select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) - state[owner * 8u + 3u]) / max(abs(select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) - state[owner * 8u + 3u]), abs(state[owner * 8u + 3u] * 0.625 + select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) - state[owner * 8u + 3u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 3u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) - state[owner * 8u + 3u]) * (state[owner * 8u + 3u] * 0.625 + select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) - state[owner * 8u + 3u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 3u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) - state[owner * 8u + 3u]) * (state[owner * 8u + 3u] * 0.625 + select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) - state[owner * 8u + 3u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 3u])), 0.00000001) + state[owner * 8u + 4u] + (state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]) * abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]), abs(state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * (state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) * (state[owner * 8u + 4u] * 0.625 + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) - state[owner * 8u + 4u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 4u])), 0.00000001)) * dot(vec2<f32>(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) + (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)))), 0.00000001), dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) + (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) + 0.00000001) * max((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))), 0.0) / max(abs((dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)))), 0.00000001)) * 1.0 / (state[owner * 8u + 0u] + (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) * abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]), abs(state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]) + 0.00000001) * max((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u]), 0.0) / max(abs((select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) * (state[owner * 8u + 0u] * 0.625 + select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.375 + dot((face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) - state[owner * 8u + 0u]) / max(dot(face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)), 0.000000000001), face_center_vec - c_owner_vec - (face_center_vec - c_neigh_cell_vec)) * 0.125 - state[owner * 8u + 0u])), 0.00000001)), normal_vec), constants.scheme == 6u && !is_boundary);
    f_r_3 = select(f_r_3, (select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 3u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 3u] - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary)) * abs(state[owner * 8u + 3u] - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 3u] - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 3u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 3u] - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 3u] - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 3u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 3u] - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 3u] - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 3u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 3u] - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 3u], select(select(state[owner * 8u + 3u], bc_value[idx * 8u + 3u], bc_kind[idx * 8u + 3u] == 1u), state[owner * 8u + 3u] + bc_value[idx * 8u + 3u] * d_own, bc_kind[idx * 8u + 3u] == 2u), is_boundary))), 0.00000001) + select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 4u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 4u] - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 4u], select(select(state[owner * 8u + 4u], bc_value[idx * 8u + 6u], bc_kind[idx * 8u + 6u] == 1u), state[owner * 8u + 4u] + bc_value[idx * 8u + 6u] * d_own, bc_kind[idx * 8u + 6u] == 2u), is_boundary))), 0.00000001)) * dot(vec2<f32>(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) + (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(1.0, 0.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(1.0, 0.0)))), 0.00000001), dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) + (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(abs(dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), abs(dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) + 0.00000001) * max((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))), 0.0) / max(abs((dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) * (dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)) * 0.625 + dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (dot(vec2<f32>(state[owner * 8u + 1u], state[owner * 8u + 2u]), vec2<f32>(0.0, 1.0)) - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0))) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - dot(vec2<f32>(select(state[neigh_idx * 8u + 1u], select(select(state[owner * 8u + 1u], bc_value[idx * 8u + 1u], bc_kind[idx * 8u + 1u] == 1u), state[owner * 8u + 1u] + bc_value[idx * 8u + 1u] * d_own, bc_kind[idx * 8u + 1u] == 2u), is_boundary), select(state[neigh_idx * 8u + 2u], select(select(state[owner * 8u + 2u], bc_value[idx * 8u + 2u], bc_kind[idx * 8u + 2u] == 1u), state[owner * 8u + 2u] + bc_value[idx * 8u + 2u] * d_own, bc_kind[idx * 8u + 2u] == 2u), is_boundary)), vec2<f32>(0.0, 1.0)))), 0.00000001)) * 1.0 / (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) + (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(abs(state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), abs(select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) + 0.00000001) * max((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)), 0.0) / max(abs((state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) * (select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary) * 0.625 + state[owner * 8u + 0u] * 0.375 + dot((face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * (state[owner * 8u + 0u] - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary)) / max(dot(face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)), 0.000000000001), face_center_vec - c_neigh_cell_vec - (face_center_vec - c_owner_vec)) * 0.125 - select(state[neigh_idx * 8u + 0u], select(select(state[owner * 8u + 0u], bc_value[idx * 8u + 0u], bc_kind[idx * 8u + 0u] == 1u), state[owner * 8u + 0u] + bc_value[idx * 8u + 0u] * d_own, bc_kind[idx * 8u + 0u] == 2u), is_boundary))), 0.00000001)), normal_vec), constants.scheme == 6u && !is_boundary);
    fluxes[idx * 8u + 3u] = (a_plus * f_l_3 - a_minus * f_r_3 + a_plus * a_minus * (u_r_3 - u_l_3)) / denom * area;
    var u_l_4: f32 = 0.0;
    var u_r_4: f32 = 0.0;
    var f_l_4: f32 = 0.0;
    var f_r_4: f32 = 0.0;
    u_l_4 = select(u_l_4, 0.0, constants.scheme == 1u && !is_boundary);
    u_r_4 = select(u_r_4, 0.0, constants.scheme == 1u && !is_boundary);
    f_l_4 = select(f_l_4, 0.0, constants.scheme == 1u && !is_boundary);
    f_r_4 = select(f_r_4, 0.0, constants.scheme == 1u && !is_boundary);
    u_l_4 = select(u_l_4, 0.0, constants.scheme == 2u && !is_boundary);
    u_r_4 = select(u_r_4, 0.0, constants.scheme == 2u && !is_boundary);
    f_l_4 = select(f_l_4, 0.0, constants.scheme == 2u && !is_boundary);
    f_r_4 = select(f_r_4, 0.0, constants.scheme == 2u && !is_boundary);
    u_l_4 = select(u_l_4, 0.0, constants.scheme == 3u && !is_boundary);
    u_r_4 = select(u_r_4, 0.0, constants.scheme == 3u && !is_boundary);
    f_l_4 = select(f_l_4, 0.0, constants.scheme == 3u && !is_boundary);
    f_r_4 = select(f_r_4, 0.0, constants.scheme == 3u && !is_boundary);
    u_l_4 = select(u_l_4, 0.0, constants.scheme == 4u && !is_boundary);
    u_r_4 = select(u_r_4, 0.0, constants.scheme == 4u && !is_boundary);
    f_l_4 = select(f_l_4, 0.0, constants.scheme == 4u && !is_boundary);
    f_r_4 = select(f_r_4, 0.0, constants.scheme == 4u && !is_boundary);
    u_l_4 = select(u_l_4, 0.0, constants.scheme == 5u && !is_boundary);
    u_r_4 = select(u_r_4, 0.0, constants.scheme == 5u && !is_boundary);
    f_l_4 = select(f_l_4, 0.0, constants.scheme == 5u && !is_boundary);
    f_r_4 = select(f_r_4, 0.0, constants.scheme == 5u && !is_boundary);
    u_l_4 = select(u_l_4, 0.0, constants.scheme == 6u && !is_boundary);
    u_r_4 = select(u_r_4, 0.0, constants.scheme == 6u && !is_boundary);
    f_l_4 = select(f_l_4, 0.0, constants.scheme == 6u && !is_boundary);
    f_r_4 = select(f_r_4, 0.0, constants.scheme == 6u && !is_boundary);
    fluxes[idx * 8u + 4u] = (a_plus * f_l_4 - a_minus * f_r_4 + a_plus * a_minus * (u_r_4 - u_l_4)) / denom * area;
    var u_l_5: f32 = 0.0;
    var u_r_5: f32 = 0.0;
    var f_l_5: f32 = 0.0;
    var f_r_5: f32 = 0.0;
    u_l_5 = select(u_l_5, 0.0, constants.scheme == 1u && !is_boundary);
    u_r_5 = select(u_r_5, 0.0, constants.scheme == 1u && !is_boundary);
    f_l_5 = select(f_l_5, 0.0, constants.scheme == 1u && !is_boundary);
    f_r_5 = select(f_r_5, 0.0, constants.scheme == 1u && !is_boundary);
    u_l_5 = select(u_l_5, 0.0, constants.scheme == 2u && !is_boundary);
    u_r_5 = select(u_r_5, 0.0, constants.scheme == 2u && !is_boundary);
    f_l_5 = select(f_l_5, 0.0, constants.scheme == 2u && !is_boundary);
    f_r_5 = select(f_r_5, 0.0, constants.scheme == 2u && !is_boundary);
    u_l_5 = select(u_l_5, 0.0, constants.scheme == 3u && !is_boundary);
    u_r_5 = select(u_r_5, 0.0, constants.scheme == 3u && !is_boundary);
    f_l_5 = select(f_l_5, 0.0, constants.scheme == 3u && !is_boundary);
    f_r_5 = select(f_r_5, 0.0, constants.scheme == 3u && !is_boundary);
    u_l_5 = select(u_l_5, 0.0, constants.scheme == 4u && !is_boundary);
    u_r_5 = select(u_r_5, 0.0, constants.scheme == 4u && !is_boundary);
    f_l_5 = select(f_l_5, 0.0, constants.scheme == 4u && !is_boundary);
    f_r_5 = select(f_r_5, 0.0, constants.scheme == 4u && !is_boundary);
    u_l_5 = select(u_l_5, 0.0, constants.scheme == 5u && !is_boundary);
    u_r_5 = select(u_r_5, 0.0, constants.scheme == 5u && !is_boundary);
    f_l_5 = select(f_l_5, 0.0, constants.scheme == 5u && !is_boundary);
    f_r_5 = select(f_r_5, 0.0, constants.scheme == 5u && !is_boundary);
    u_l_5 = select(u_l_5, 0.0, constants.scheme == 6u && !is_boundary);
    u_r_5 = select(u_r_5, 0.0, constants.scheme == 6u && !is_boundary);
    f_l_5 = select(f_l_5, 0.0, constants.scheme == 6u && !is_boundary);
    f_r_5 = select(f_r_5, 0.0, constants.scheme == 6u && !is_boundary);
    fluxes[idx * 8u + 5u] = (a_plus * f_l_5 - a_minus * f_r_5 + a_plus * a_minus * (u_r_5 - u_l_5)) / denom * area;
    var u_l_6: f32 = 0.0;
    var u_r_6: f32 = 0.0;
    var f_l_6: f32 = 0.0;
    var f_r_6: f32 = 0.0;
    u_l_6 = select(u_l_6, 0.0, constants.scheme == 1u && !is_boundary);
    u_r_6 = select(u_r_6, 0.0, constants.scheme == 1u && !is_boundary);
    f_l_6 = select(f_l_6, 0.0, constants.scheme == 1u && !is_boundary);
    f_r_6 = select(f_r_6, 0.0, constants.scheme == 1u && !is_boundary);
    u_l_6 = select(u_l_6, 0.0, constants.scheme == 2u && !is_boundary);
    u_r_6 = select(u_r_6, 0.0, constants.scheme == 2u && !is_boundary);
    f_l_6 = select(f_l_6, 0.0, constants.scheme == 2u && !is_boundary);
    f_r_6 = select(f_r_6, 0.0, constants.scheme == 2u && !is_boundary);
    u_l_6 = select(u_l_6, 0.0, constants.scheme == 3u && !is_boundary);
    u_r_6 = select(u_r_6, 0.0, constants.scheme == 3u && !is_boundary);
    f_l_6 = select(f_l_6, 0.0, constants.scheme == 3u && !is_boundary);
    f_r_6 = select(f_r_6, 0.0, constants.scheme == 3u && !is_boundary);
    u_l_6 = select(u_l_6, 0.0, constants.scheme == 4u && !is_boundary);
    u_r_6 = select(u_r_6, 0.0, constants.scheme == 4u && !is_boundary);
    f_l_6 = select(f_l_6, 0.0, constants.scheme == 4u && !is_boundary);
    f_r_6 = select(f_r_6, 0.0, constants.scheme == 4u && !is_boundary);
    u_l_6 = select(u_l_6, 0.0, constants.scheme == 5u && !is_boundary);
    u_r_6 = select(u_r_6, 0.0, constants.scheme == 5u && !is_boundary);
    f_l_6 = select(f_l_6, 0.0, constants.scheme == 5u && !is_boundary);
    f_r_6 = select(f_r_6, 0.0, constants.scheme == 5u && !is_boundary);
    u_l_6 = select(u_l_6, 0.0, constants.scheme == 6u && !is_boundary);
    u_r_6 = select(u_r_6, 0.0, constants.scheme == 6u && !is_boundary);
    f_l_6 = select(f_l_6, 0.0, constants.scheme == 6u && !is_boundary);
    f_r_6 = select(f_r_6, 0.0, constants.scheme == 6u && !is_boundary);
    fluxes[idx * 8u + 6u] = (a_plus * f_l_6 - a_minus * f_r_6 + a_plus * a_minus * (u_r_6 - u_l_6)) / denom * area;
    var u_l_7: f32 = 0.0;
    var u_r_7: f32 = 0.0;
    var f_l_7: f32 = 0.0;
    var f_r_7: f32 = 0.0;
    u_l_7 = select(u_l_7, 0.0, constants.scheme == 1u && !is_boundary);
    u_r_7 = select(u_r_7, 0.0, constants.scheme == 1u && !is_boundary);
    f_l_7 = select(f_l_7, 0.0, constants.scheme == 1u && !is_boundary);
    f_r_7 = select(f_r_7, 0.0, constants.scheme == 1u && !is_boundary);
    u_l_7 = select(u_l_7, 0.0, constants.scheme == 2u && !is_boundary);
    u_r_7 = select(u_r_7, 0.0, constants.scheme == 2u && !is_boundary);
    f_l_7 = select(f_l_7, 0.0, constants.scheme == 2u && !is_boundary);
    f_r_7 = select(f_r_7, 0.0, constants.scheme == 2u && !is_boundary);
    u_l_7 = select(u_l_7, 0.0, constants.scheme == 3u && !is_boundary);
    u_r_7 = select(u_r_7, 0.0, constants.scheme == 3u && !is_boundary);
    f_l_7 = select(f_l_7, 0.0, constants.scheme == 3u && !is_boundary);
    f_r_7 = select(f_r_7, 0.0, constants.scheme == 3u && !is_boundary);
    u_l_7 = select(u_l_7, 0.0, constants.scheme == 4u && !is_boundary);
    u_r_7 = select(u_r_7, 0.0, constants.scheme == 4u && !is_boundary);
    f_l_7 = select(f_l_7, 0.0, constants.scheme == 4u && !is_boundary);
    f_r_7 = select(f_r_7, 0.0, constants.scheme == 4u && !is_boundary);
    u_l_7 = select(u_l_7, 0.0, constants.scheme == 5u && !is_boundary);
    u_r_7 = select(u_r_7, 0.0, constants.scheme == 5u && !is_boundary);
    f_l_7 = select(f_l_7, 0.0, constants.scheme == 5u && !is_boundary);
    f_r_7 = select(f_r_7, 0.0, constants.scheme == 5u && !is_boundary);
    u_l_7 = select(u_l_7, 0.0, constants.scheme == 6u && !is_boundary);
    u_r_7 = select(u_r_7, 0.0, constants.scheme == 6u && !is_boundary);
    f_l_7 = select(f_l_7, 0.0, constants.scheme == 6u && !is_boundary);
    f_r_7 = select(f_r_7, 0.0, constants.scheme == 6u && !is_boundary);
    fluxes[idx * 8u + 7u] = (a_plus * f_l_7 - a_minus * f_r_7 + a_plus * a_minus * (u_r_7 - u_l_7)) / denom * area;
}
